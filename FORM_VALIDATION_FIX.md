# Исправление проблемы сброса данных формы при ошибке валидации

## Проблема
При ошибке валидации формы создания задания все введенные пользователем данные сбрасывались, что было очень неудобно для пользователя.

## Решение

### 1. Улучшение TaskForm (shift_log/forms.py)
- Улучшена логика определения отдела в методе `__init__`
- Добавлена более надежная обработка данных POST при ошибке валидации
- Улучшена обработка исключений при получении отдела из данных формы

### 2. Добавление методов form_invalid в представления (shift_log/views.py)
- **TaskCreateView.form_invalid()**: Сохраняет введенные данные в initial полях формы
- **TaskUpdateView.form_invalid()**: Аналогичная логика для редактирования

### 3. Упрощенная логика сохранения данных
- Данные сохраняются напрямую в `form.fields[field_name].initial`
- Убрана сложная логика сессии для упрощения и надежности

## Результат
Теперь при ошибке валидации формы создания задания:
- ✅ Все введенные данные сохраняются в initial полях формы
- ✅ Пользователю не нужно вводить данные заново
- ✅ Отображаются только ошибки валидации
- ✅ Улучшен пользовательский опыт
- ✅ Простая и надежная логика без сложных зависимостей

## Исправления
- Исправлена ошибка `'dict' object has no attribute 'dict'`
- Упрощена логика сохранения данных
- Убрана избыточная логика сессии

## Тестирование
Создан и успешно выполнен тест, подтверждающий корректную работу сохранения данных формы при ошибке валидации. 
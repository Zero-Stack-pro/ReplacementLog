# Исправления в системе сменного журнала

## Проблемы, которые были решены

### 1. Ошибка AttributeError: 'Task' object has no attribute 'is_overdue'

**Проблема:** При попытке доступа к дашборду возникала ошибка, так как в модели `Task` отсутствовало свойство `is_overdue`.

**Решение:** Добавлено свойство `is_overdue` в модель `Task`:

```python
@property
def is_overdue(self):
    """Проверяет, просрочена ли задача"""
    from django.utils import timezone
    return (
        self.status not in ['completed', 'cancelled'] and 
        self.due_date < timezone.now()
    )
```

**Логика работы:**
- Задача считается просроченной, если её статус не 'completed' или 'cancelled'
- И срок выполнения (`due_date`) меньше текущего времени
- Завершенные и отмененные задачи не считаются просроченными

### 2. Отсутствие пользователей в системе

**Проблема:** В базе данных не было пользователей, что не позволяло войти в систему.

**Решение:** Исправлен и запущен скрипт `create_test_data.py` для создания тестовых данных.

**Созданные пользователи:**

#### Администратор
- **Логин:** `admin`
- **Пароль:** `admin123`
- **Роль:** Администратор системы
- **Отдел:** Администрация

#### Руководители отделов
- **it_supervisor** / `supervisor123` - Руководитель IT отдела
- **prod_supervisor** / `supervisor123` - Руководитель Производства
- **sec_supervisor** / `supervisor123` - Руководитель Безопасности
- **log_supervisor** / `supervisor123` - Руководитель Логистики

#### Сотрудники
- **it_worker1, it_worker2** / `worker123` - IT отдел
- **prod_worker1, prod_worker2** / `worker123` - Производство
- **sec_worker1, sec_worker2** / `worker123` - Безопасность
- **log_worker1, log_worker2** / `worker123` - Логистика

### 3. Исправления в скрипте создания тестовых данных

**Проблема:** В скрипте `create_test_data.py` использовались неправильные названия полей для модели `ShiftType`.

**Исправления:**
- `shift_pattern` → `periodicity`
- `shift_duration_hours` → `duration_hours`
- Удалено поле `rest_days` (не существует в модели)
- Удалено поле `shift` из создания задач (не существует в модели Task)

### 4. Статусы задач

**Подтверждено:** В системе есть все необходимые статусы задач:

- `pending` - Ожидает
- `in_progress` - В работе
- `completed` - Завершено
- `cancelled` - Отменено

## Результат

✅ **Система полностью функциональна**
- Дашборд загружается без ошибок
- Все пользователи могут войти в систему
- Свойство `is_overdue` работает корректно
- Созданы тестовые данные (отделы, смены, задачи)

## Тестирование

Создан и успешно выполнен тест для проверки свойства `is_overdue`:
- Задачи со сроком в будущем → `is_overdue = False`
- Активные задачи со сроком в прошлом → `is_overdue = True`
- Завершенные задачи → `is_overdue = False`
- Отмененные задачи → `is_overdue = False`

## Доступ к системе

Сервер запущен на `http://127.0.0.1:8000/`

Для входа используйте любые из созданных учетных записей выше. 